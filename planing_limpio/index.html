<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Calculadora de Horas de Servicio</title>
    <link rel="stylesheet" href="css/sheet.css" />
    <link rel="icon" type="image/svg+xml" href="favicons/favicon.svg" />
    <link
      rel="icon"
      type="image/png"
      sizes="96x96"
      href="favicons/favicon-96x96.png"
    />
    <link rel="icon" type="image/x-icon" href="favicons/favicon.ico" />
    <link rel="apple-touch-icon" href="favicons/apple-touch-icon.png" />
    <link rel="manifest" href="favicons/site.webmanifest" />
    <script src="https://cdn.jsdelivr.net/npm/slim-select@2.8.0/dist/slimselect.min.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/slim-select@2.8.0/dist/slimselect.min.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="container">
      <!-- Cabecera principal -->
      <div class="header">
        <h1>üïí Calculadora de Horas de Servicio</h1>
        <p>Calcula el balance de horas mensuales seg√∫n tu plan.</p>
      </div>
      <form id="mainForm">
        <div class="top-controls-v2">
          <div class="styled-select-group">
            <label for="year">A√±o</label>
            <div class="select-wrapper">
              <select id="year" class="styled-select slim-select"></select>
              <span class="select-arrow"></span>
            </div>
          </div>
          <div class="styled-select-group">
            <label for="month">Mes</label>
            <div class="select-wrapper">
              <select id="month" class="styled-select slim-select">
                <option value="0">Enero</option>
                <option value="1">Febrero</option>
                <option value="2">Marzo</option>
                <option value="3">Abril</option>
                <option value="4">Mayo</option>
                <option value="5">Junio</option>
                <option value="6">Julio</option>
                <option value="7">Agosto</option>
                <option value="8">Septiembre</option>
                <option value="9">Octubre</option>
                <option value="10">Noviembre</option>
                <option value="11">Diciembre</option>
              </select>
              <span class="select-arrow"></span>
            </div>
          </div>
          <div class="assigned-hours-field">
            <label for="totalHours">Horas asignadas al mes</label>
            <select id="totalHours" class="assigned-hours-input-v2 big-hours slim-square" required>
              <option value="">--</option>
              <!-- Opciones generadas por JS -->
            </select>
          </div>
        </div>

        <div class="weekdays-settings">
          <label style="font-weight:bold; margin-bottom: 0.5rem; display:block;">Festivos:</label>
          <div class="weekdays-list" style="width: 100%;">
            <div class="weekday-item" style="display: flex; flex-direction: column; align-items: center; min-width: 90px;">
              <label>Contabilizar</label>
              <label class="switch">
                <input type="checkbox" id="includeOffdays" />
                <span class="slider round"></span>
              </label>
              <div id="festivo-hours-group" style="display: none; width: 140px; margin-top: 0.3rem;">
                <select id="hours-festivo" class="weekday-hours">
                  <option value="">--</option>
                  <!-- Opciones generadas por JS -->
                </select>
              </div>
            </div>
          </div>
          <label style="font-weight:bold; margin-bottom: 0.5rem; display:block;">D√≠as de la semana con servicio:</label>
          <div class="weekdays-list" style="width: 100%;">
            <div class="weekday-item" style="display: flex; flex-direction: column; align-items: center; min-width: 90px;">
              <label>Lunes</label>
              <label class="switch">
                <input type="checkbox" id="weekday-mon" />
                <span class="slider round"></span>
              </label>
              <select id="hours-mon" class="weekday-hours" placeholder="Horas ese d√≠a" step="0.25" min="0" style="width: 140px; margin-top: 0.3rem; display: none;" required>
                <option value="">--</option>
                <!-- Opciones generadas por JS -->
              </select>
            </div>
            <div class="weekday-item" style="display: flex; flex-direction: column; align-items: center; min-width: 90px;">
              <label>Martes</label>
              <label class="switch">
                <input type="checkbox" id="weekday-tue" />
                <span class="slider round"></span>
              </label>
              <select id="hours-tue" class="weekday-hours" placeholder="Horas ese d√≠a" step="0.25" min="0" style="width: 140px; margin-top: 0.3rem; display: none;" required>
                <option value="">--</option>
                <!-- Opciones generadas por JS -->
              </select>
            </div>
            <div class="weekday-item" style="display: flex; flex-direction: column; align-items: center; min-width: 90px;">
              <label>Mi√©rcoles</label>
              <label class="switch">
                <input type="checkbox" id="weekday-wed" />
                <span class="slider round"></span>
              </label>
              <select id="hours-wed" class="weekday-hours" placeholder="Horas ese d√≠a" step="0.25" min="0" style="width: 140px; margin-top: 0.3rem; display: none;" required>
                <option value="">--</option>
                <!-- Opciones generadas por JS -->
              </select>
            </div>
            <div class="weekday-item" style="display: flex; flex-direction: column; align-items: center; min-width: 90px;">
              <label>Jueves</label>
              <label class="switch">
                <input type="checkbox" id="weekday-thu" />
                <span class="slider round"></span>
              </label>
              <select id="hours-thu" class="weekday-hours" placeholder="Horas ese d√≠a" step="0.25" min="0" style="width: 140px; margin-top: 0.3rem; display: none;" required>
                <option value="">--</option>
                <!-- Opciones generadas por JS -->
              </select>
            </div>
            <div class="weekday-item" style="display: flex; flex-direction: column; align-items: center; min-width: 90px;">
              <label>Viernes</label>
              <label class="switch">
                <input type="checkbox" id="weekday-fri" />
                <span class="slider round"></span>
              </label>
              <select id="hours-fri" class="weekday-hours" placeholder="Horas ese d√≠a" step="0.25" min="0" style="width: 140px; margin-top: 0.3rem; display: none;" required>
                <option value="">--</option>
                <!-- Opciones generadas por JS -->
              </select>
            </div>
            <div class="weekday-item" style="display: flex; flex-direction: column; align-items: center; min-width: 90px;">
              <label>S√°bado</label>
              <label class="switch">
                <input type="checkbox" id="weekday-sat" />
                <span class="slider round"></span>
              </label>
              <select id="hours-sat" class="weekday-hours" placeholder="Horas ese d√≠a" step="0.25" min="0" style="width: 140px; margin-top: 0.3rem; display: none;" required>
                <option value="">--</option>
                <!-- Opciones generadas por JS -->
              </select>
            </div>
            <div class="weekday-item" style="display: flex; flex-direction: column; align-items: center; min-width: 90px;">
              <label>Domingo</label>
              <label class="switch">
                <input type="checkbox" id="weekday-sun" />
                <span class="slider round"></span>
              </label>
              <select id="hours-sun" class="weekday-hours" placeholder="Horas ese d√≠a" step="0.25" min="0" style="width: 140px; margin-top: 0.3rem; display: none;" required>
                <option value="">--</option>
                <!-- Opciones generadas por JS -->
              </select>
            </div>
          </div>
        </div>

        <div class="main-action" style="display: flex; justify-content: center; gap: 1rem; align-items: center;">
          <button class="btn" id="calculateBtn" type="button">Calcular Balance</button>
          <button class="btn btn-secondary" id="resetBtn" type="button">Reset</button>
          <button class="btn btn-secondary" id="clearCacheBtn" type="button">Limpiar Cach√©</button>
        </div>
      </form>

      <div id="loading" class="loading">
        <div class="spinner"></div>
        <p>Cargando datos de festivos...</p>
      </div>

      <div id="error-container"></div>

      <!-- Resultados -->
      <div
        id="results-container"
        class="results-container"
        style="display: none"
      >
        <div class="summary-card">
          <h2>üìä Balance del Mes</h2>
          <p class="balance-value" id="balanceValue">0.00 horas</p>
          <p class="balance-text" id="balanceText">--</p>
        </div>
        <div class="details-grid">
          <div class="detail-card">
            <h3 id="totalMonthHoursTitle">
              üóìÔ∏è Horas para <span id="monthNameTitle">Julio</span>
              <span id="yearTitle">2025</span>
            </h3>
            <p id="totalMonthHours">--</p>
          </div>
          <div class="detail-card">
            <h3>‚úÖ Horas realizadas hasta hoy</h3>
            <p id="hoursSoFar">--</p>
          </div>
          <div class="detail-card">
            <h3>üíº D√≠as laborables</h3>
            <p id="workdays">--</p>
          </div>
          <div class="detail-card">
            <h3>üéâ Fines de semana / Festivos</h3>
            <p id="offDays">--</p>
          </div>
        </div>
      </div>
      <!-- Festivos personalizados -->
      <div class="results-container">
        <button id="toggleHolidayListBtn" class="btn" type="button">
          üéâ Mostrar festivos
        </button>
        <div id="holidayListContainer" class="holiday-list-container">
          <h3>üéà Festivos usados en el c√°lculo</h3>
          <ul id="holidayList"></ul>
          <form id="addHolidayForm" class="add-holiday-form">
            <input type="date" id="customHolidayDate" required />
            <input
              type="text"
              id="customHolidayName"
              placeholder="Nombre del festivo"
              required
            />
            <button type="submit" class="btn">+</button>
          </form>
        </div>
      </div>
    </div>
    <script src="main.js?v=2.0"></script>
    <script>
      // Inicializar SlimSelect solo para los selects principales
      document.addEventListener("DOMContentLoaded", function () {
        new SlimSelect({ select: "#year", settings: { showSearch: false } });
        new SlimSelect({ select: "#month", settings: { showSearch: false } });
        new SlimSelect({ select: "#totalHours", settings: { showSearch: false } });
      });
    </script>
  </body>
</html>
